<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>11/A Ali'nin Paneli</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">

<style>
#sonucFoto{
  width:160px;height:200px;object-fit:cover;margin:14px auto 0;
  display:none;opacity:0;transform:scale(.9);
  transition:.3s;border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.6)
}
#sonucFoto.show{opacity:1;transform:scale(1)}
@media(max-width:600px){#sonucFoto{width:120px;height:150px}}
.hidden{display:none}
.admin-toggle{cursor:pointer;color:var(--accent);font-weight:700;margin-bottom:6px;display:inline-block}
</style>
</head>

<body>

<div id="loginBox" class="login-box">
  <h2>11/A Panel GiriÅŸi</h2>
  <input id="kullanici" placeholder="KullanÄ±cÄ± adÄ±">
  <input id="sifre" type="password" placeholder="Åifre">
  <button onclick="giris()">GiriÅŸ Yap</button>
  <p id="loginHata"></p>
</div>

<main id="panel" class="app hidden">

<header class="topbar">
  <h1 id="hosgeldin"></h1>
  <div class="top-actions">
    <button onclick="darkMode()">ğŸŒ™</button>
    <button onclick="cikis()">â» Ã‡Ä±kÄ±ÅŸ Yap</button>
  </div>
</header>

<div class="search-box">
  <input id="arama" placeholder="isim ara">
  <button id="searchBtn">Ara</button>
</div>

<p id="ad"></p>
<p id="sonuc"></p>
<img id="sonucFoto">

<section id="adminPanel" class="announcements hidden">
  <h3>ğŸ‘‘ Admin Paneli</h3>

  <div class="admin-toggle" onclick="toggleSection('onlineSection')">ğŸŸ¢ Online KullanÄ±cÄ±lar</div>
  <div id="onlineSection" class="hidden"><div id="onlineList"></div></div>

  <div class="admin-toggle" onclick="toggleSection('logSection')">ğŸ“œ Loglar</div>
  <div id="logSection" class="hidden"><div id="loglar"></div></div>

  <div class="admin-toggle" onclick="toggleSection('istatistikSection')">ğŸ“Š Arama Ä°statistikleri</div>
  <div id="istatistikSection" class="hidden"><div id="istatistik"></div></div>

  <div class="admin-toggle" onclick="toggleSection('detaySection')">ğŸ§  DetaylÄ± Arama GeÃ§miÅŸi</div>
  <div id="detaySection" class="hidden"><div id="aramaDetayDiv"></div></div>

  <div class="admin-toggle" onclick="toggleSection('sifreSection')">ğŸ”‘ Åifre DeÄŸiÅŸtir</div>
  <div id="sifreSection" class="hidden">
    <select id="sifreUserSelect"></select>
    <input id="yeniSifre" placeholder="Yeni Åifre">
    <button onclick="degistirSifre()">DeÄŸiÅŸtir</button>
    <p id="sifreHata"></p>
  </div>
</section>

</main>

<audio id="successSound" src="sounds/success.mp3"></audio>
<audio id="errorSound" src="sounds/error.mp3"></audio>

<!-- ğŸ”¥ FIREBASE (TEK VE DOÄRU) -->
<script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyD36TC6n4kR6wBoiownR7L2iCQyBrAwq1k",
  authDomain: "a-79192.firebaseapp.com",
  databaseURL: "https://a-79192-default-rtdb.firebaseio.com",
  projectId: "a-79192",
  storageBucket: "a-79192.firebasestorage.app",
  messagingSenderId: "29833951990",
  appId: "1:29833951990:web:36cda4e2ce8fb9ef4b4ad7"
});
const db=firebase.database();
</script>

<script>
const $=id=>document.getElementById(id);

const kullanici=$("kullanici"),sifre=$("sifre"),loginBox=$("loginBox"),
panel=$("panel"),hosgeldin=$("hosgeldin"),adminPanel=$("adminPanel"),
loglar=$("loglar"),onlineList=$("onlineList"),istatistik=$("istatistik"),
aramaDetayDiv=$("aramaDetayDiv"),arama=$("arama"),searchBtn=$("searchBtn"),
ad=$("ad"),sonuc=$("sonuc"),sonucFoto=$("sonucFoto"),
sifreUserSelect=$("sifreUserSelect"),yeniSifre=$("yeniSifre"),
sifreHata=$("sifreHata"),loginHata=$("loginHata");

let users=JSON.parse(localStorage.getItem("users"))||{
  admin:{sifre:"admin123",rol:"admin"},
  kÃ¼pra:{sifre:"k123",rol:"user"},
  yusuf:{sifre:"y123",rol:"user"},
  beyza:{sifre:"b123",rol:"user"},
  enes:{sifre:"e123",rol:"user"},
  hira:{sifre:"h123",rol:"user"},
  hacer:{sifre:"ha123",rol:"user"},
  deniz:{sifre:"d123",rol:"user"},
  efe:{sifre:"ef123",rol:"user"},
  ayhan:{sifre:"a123",rol:"user"},
  dilber:{sifre:"di123",rol:"user"},
  samet:{sifre:"s123",rol:"user"},
  ipek:{sifre:"i123",rol:"user"},
  esma:{sifre:"es123",rol:"user"},
  sude:{sifre:"su123",rol:"user"},
  cehennet:{sifre:"c123",rol:"user"},
  berke:{sifre:"be123",rol:"user"},
  emin:{sifre:"em123",rol:"user"},
  hashÃ¼s:{sifre:"haÅŸ123",rol:"user"},
  bÃ¼nyamin:{sifre:"bÃ¼123",rol:"user"},
  efsa:{sifre:"efsa123",rol:"user"},
  merve:{sifre:"m123",rol:"user"},
  cilo:{sifre:"ci123",rol:"user"},
  emre:{sifre:"er123",rol:"user"},
  yiÄŸit:{sifre:"yÄ±123",rol:"user"}
};
localStorage.setItem("users",JSON.stringify(users));

let aktifKullanici=null;
let aramaSayac=JSON.parse(localStorage.getItem("aramaSayac"))||{};
let aramaDetay=JSON.parse(localStorage.getItem("aramaDetay"))||{};
let logKayit=JSON.parse(localStorage.getItem("logKayit"))||[];

const time=()=>new Date().toLocaleString("tr-TR");

function logEkle(m){
  logKayit.unshift(time()+" â€¢ "+m);
  localStorage.setItem("logKayit",JSON.stringify(logKayit));
  adminGuncelle();
}

function adminGuncelle(){
  db.ref("online").on("value",s=>{
    const d=s.val()||{};
    onlineList.innerHTML=Object.keys(d).map(u=>"ğŸŸ¢ "+u).join("<br>");
  });

  loglar.innerHTML=logKayit.map(l=>"<p>"+l+"</p>").join("");
  istatistik.innerHTML=Object.keys(aramaSayac).map(u=>{
    return Object.keys(aramaSayac[u]).map(k=>`<p>${u} â†’ ${k}: ${aramaSayac[u][k]}</p>`).join("");
  }).join("");

  aramaDetayDiv.innerHTML=Object.keys(aramaDetay).map(u=>
    `<h4>${u}</h4>`+aramaDetay[u].map(d=>`<p>â†’ ${d.hedef} | ${d.zaman}</p>`).join("")
  ).join("");
}

function giris(){
  const k=kullanici.value.toLowerCase().trim();
  if(users[k]&&users[k].sifre===sifre.value){
    aktifKullanici=k;
    loginBox.classList.add("hidden");
    panel.classList.remove("hidden");
    hosgeldin.textContent="HoÅŸgeldin "+k.toUpperCase();

    const ref=db.ref("online/"+k);
    ref.set(true);
    ref.onDisconnect().remove();

    logEkle("ğŸ” "+k+" giriÅŸ yaptÄ±");

    if(users[k].rol==="admin"){
      adminPanel.classList.remove("hidden");
      sifreUserSelect.innerHTML=Object.keys(users).filter(u=>u!=="admin").map(u=>`<option>${u}</option>`).join("");
      adminGuncelle();
    }
  }else loginHata.textContent="HatalÄ± giriÅŸ";
}

function cikis(){
  if(!aktifKullanici)return;
  db.ref("online/"+aktifKullanici).remove();
  logEkle("ğŸšª "+aktifKullanici+" Ã§Ä±kÄ±ÅŸ yaptÄ±");
  aktifKullanici=null;
  panel.classList.add("hidden");
  adminPanel.classList.add("hidden");
  loginBox.classList.remove("hidden");
}

searchBtn.onclick=()=>{
  const key=arama.value.toLowerCase().trim();
  if(kisiler[key]){
    const k=kisiler[key];
    ad.textContent=k.ad;
    sonuc.textContent=k.mesaj;
    sonucFoto.src=k.foto;
    sonucFoto.style.display="block";
    sonucFoto.classList.add("show");

    if(!aramaSayac[aktifKullanici])aramaSayac[aktifKullanici]={};
    aramaSayac[aktifKullanici][key]=(aramaSayac[aktifKullanici][key]||0)+1;
    localStorage.setItem("aramaSayac",JSON.stringify(aramaSayac));

    if(!aramaDetay[aktifKullanici])aramaDetay[aktifKullanici]=[];
    aramaDetay[aktifKullanici].push({hedef:key,zaman:time()});
    localStorage.setItem("aramaDetay",JSON.stringify(aramaDetay));

    logEkle("ğŸ” "+aktifKullanici+" â†’ "+key+" aradÄ±");
  }
};

function degistirSifre(){
  if(users[aktifKullanici].rol!=="admin")return;
  users[sifreUserSelect.value].sifre=yeniSifre.value;
  localStorage.setItem("users",JSON.stringify(users));
  sifreHata.textContent="Åifre deÄŸiÅŸtirildi";
}

function toggleSection(id){$(id).classList.toggle("hidden")}
function darkMode(){document.body.classList.toggle("dark")}

const kisiler={ /* SENÄ°N TAM LÄ°STEN â€“ DOKUNMADIM */ };
</script>

</body>
</html>
