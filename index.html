<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>11/A Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#111;color:#fff;margin:0}
.hidden{display:none}
.login-box,main{padding:20px}
input,button,select{padding:10px;margin:5px 0;width:100%}
button{cursor:pointer}

#sonucFoto{
 width:160px;height:200px;object-fit:cover;
 display:none;opacity:0;transform:scale(.9);
 transition:.3s;border-radius:14px;margin:auto
}
#sonucFoto.show{opacity:1;transform:scale(1)}
.admin-toggle{cursor:pointer;font-weight:bold;margin-top:10px}
</style>
</head>

<body>

<div id="loginBox" class="login-box">
<h2>11/A GiriÅŸ</h2>
<input id="kullanici" placeholder="KullanÄ±cÄ± adÄ±">
<input id="sifre" type="password" placeholder="Åifre">
<button onclick="giris()">GiriÅŸ</button>
<p id="loginHata"></p>
</div>

<main id="panel" class="hidden">
<h2 id="hosgeldin"></h2>

<input id="arama" placeholder="Ä°sim ara">
<button id="searchBtn">Ara</button>

<p id="ad"></p>
<p id="sonuc"></p>
<img id="sonucFoto">

<section id="adminPanel" class="hidden">
<h3>ğŸ‘‘ Admin Paneli</h3>

<div class="admin-toggle" onclick="toggle('onlineDiv')">ğŸŸ¢ Online KullanÄ±cÄ±lar</div>
<div id="onlineDiv" class="hidden"></div>

<div class="admin-toggle" onclick="toggle('loglar')">ğŸ“œ Arama LoglarÄ±</div>
<div id="loglar" class="hidden"></div>

<div class="admin-toggle" onclick="toggle('istatistik')">ğŸ“Š Ä°statistik</div>
<div id="istatistik" class="hidden"></div>

<div class="admin-toggle" onclick="toggle('sifreDiv')">ğŸ”‘ Åifre DeÄŸiÅŸtir</div>
<div id="sifreDiv" class="hidden">
<select id="sifreUserSelect"></select>
<input id="yeniSifre" placeholder="Yeni ÅŸifre">
<button onclick="degistirSifre()">DeÄŸiÅŸtir</button>
<p id="sifreHata"></p>
</div>
</section>

<button onclick="cikis()">Ã‡Ä±kÄ±ÅŸ</button>
</main>

<script>
const users=JSON.parse(localStorage.getItem("users"))||{
 admin:{sifre:"admin123",rol:"admin"},
 kÃ¼pra:{sifre:"k123",rol:"user"},
 yusuf:{sifre:"y123",rol:"user"},
 beyza:{sifre:"b123",rol:"user"},
 enes:{sifre:"e123",rol:"user"},
 hira:{sifre:"h123",rol:"user"},
 hacer:{sifre:"ha123",rol:"user"},
 deniz:{sifre:"d123",rol:"user"},
 efe:{sifre:"ef123",rol:"user"},
 ayhan:{sifre:"a123",rol:"user"},
 dilber:{sifre:"di123",rol:"user"},
 samet:{sifre:"s123",rol:"user"},
 ipek:{sifre:"i123",rol:"user"},
 esma:{sifre:"es123",rol:"user"},
 sude:{sifre:"su123",rol:"user"},
 cehennet:{sifre:"c123",rol:"user"},
 berke:{sifre:"be123",rol:"user"},
 emin:{sifre:"em123",rol:"user"},
 hashÃ¼s:{sifre:"haÅŸ123",rol:"user"},
 bÃ¼nyamin:{sifre:"bÃ¼123",rol:"user"},
 efsa:{sifre:"efsa123",rol:"user"},
 merve:{sifre:"m123",rol:"user"},
 cilo:{sifre:"ci123",rol:"user"},
 emre:{sifre:"er123",rol:"user"},
 yiÄŸit:{sifre:"yÄ±123",rol:"user"}
};
localStorage.setItem("users",JSON.stringify(users));

const kisiler={
 kÃ¼pra:{ad:"KÃ¼pra",mesaj:"hafif",foto:"fotos/kÃ¼pra.jpg"},
 yusuf:{ad:"Yusuf",mesaj:"Ä±rkÃ§Ä±",foto:"fotos/yusuf.jpg"},
 beyza:{ad:"Beyza",mesaj:"egoist sÄ±Ã§an",foto:"fotos/beyza.jpg"},
 enes:{ad:"Enes",mesaj:"kkaahhppee",foto:"fotos/enes.jpg"},
 hira:{ad:"Hira",mesaj:"beyinsiz",foto:"fotos/hira.jpg"},
 hacer:{ad:"Hacer",mesaj:"erkek",foto:"fotos/hacer.jpg"},
 deniz:{ad:"Deniz",mesaj:"taklitman",foto:"fotos/deniz.jpg"},
 efe:{ad:"Efe",mesaj:"yaÅŸÄ±yor",foto:"fotos/efe.jpg"},
 ayhan:{ad:"Ayhan",mesaj:"gergin adam",foto:"fotos/ayhan.jpg"},
 dilber:{ad:"Dilber",mesaj:"ÅŸevvalin50tonu",foto:"fotos/dilber.jpg"},
 samet:{ad:"Samet",mesaj:"baÅŸkan",foto:"fotos/samet.jpg"},
 ipek:{ad:"Ä°pek",mesaj:"gergedan",foto:"fotos/ipek.jpg"},
 esma:{ad:"Esma",mesaj:"umrede",foto:"fotos/esma.jpg"},
 sude:{ad:"Sude",mesaj:"gÃ¶zlÃ¼k yokki",foto:"fotos/sude.jpg"},
 cehennet:{ad:"Cehennet",mesaj:"depremci",foto:"fotos/cehennet.jpg"},
 berke:{ad:"Berke",mesaj:"kas kÃ¼tlesi",foto:"fotos/berke.jpg"},
 emin:{ad:"Emin",mesaj:"atatÃ¼rk",foto:"fotos/emin.jpg"},
 hashÃ¼s:{ad:"HashÃ¼s",mesaj:"ineÄŸin kalÃ§asÄ±",foto:"fotos/hashÃ¼s.jpg"},
 bÃ¼nyamin:{ad:"BÃ¼nyamin",mesaj:"bilekkÄ±ran",foto:"fotos/bÃ¼nyamin.jpg"},
 efsa:{ad:"Efsa",mesaj:"baÅŸkaniye",foto:"fotos/efsa.jpg"},
 merve:{ad:"Merve",mesaj:"efsanÄ±n elli tonu",foto:"fotos/merve.jpg"},
 cilo:{ad:"Cilo",mesaj:"godfather",foto:"fotos/cilo.jpg"},
 emre:{ad:"Emre",mesaj:"bÄ±yÄ±klÄ±",foto:"fotos/emre.jpg"},
 yiÄŸit:{ad:"YiÄŸit",mesaj:"bjkci",foto:"fotos/yiÄŸit.jpg"}
};

let aktif="";

function giris(){
 const k=kullanici.value.toLowerCase().trim();
 if(users[k]&&users[k].sifre===sifre.value){
  aktif=k;
  loginBox.classList.add("hidden");
  panel.classList.remove("hidden");
  hosgeldin.textContent="HoÅŸgeldin "+k;
  firebaseOnline(k);

  if(users[k].rol==="admin"){
   adminPanel.classList.remove("hidden");
   sifreUserSelect.innerHTML=Object.keys(users)
    .filter(u=>u!=="admin")
    .map(u=>`<option>${u}</option>`).join("");
   startStatusListener();
  }
 }else loginHata.textContent="HatalÄ± giriÅŸ";
}

function cikis(){
 if(aktif){
  const r=ref(db,"status/"+aktif);
  set(r,{name:aktif,state:"offline",last:Date.now()});
 }
 location.reload();
}

searchBtn.onclick=()=>{
 const k=arama.value.toLowerCase().trim();
 if(!kisiler[k]) return sonuc.textContent="BulunamadÄ±";
 const x=kisiler[k];
 ad.textContent=x.ad;
 sonuc.textContent=x.mesaj;
 sonucFoto.src=x.foto;
 sonucFoto.style.display="block";
 setTimeout(()=>sonucFoto.classList.add("show"),10);
 logla(k);
};

function logla(a){
 const l=JSON.parse(localStorage.getItem("logs"))||[];
 l.push({u:aktif,a,t:new Date().toLocaleString()});
 localStorage.setItem("logs",JSON.stringify(l));
 guncelleAdmin();
}

function guncelleAdmin(){
 if(users[aktif]?.rol!=="admin")return;
 const l=JSON.parse(localStorage.getItem("logs"))||[];
 loglar.innerHTML=l.map(x=>`${x.u} â†’ ${x.a} (${x.t})`).reverse().join("<br>");
 const s={}; l.forEach(x=>s[x.a]=(s[x.a]||0)+1);
 istatistik.innerHTML=Object.entries(s).map(x=>`${x[0]} : ${x[1]}`).join("<br>");
}

function degistirSifre(){
 const u=sifreUserSelect.value;
 users[u].sifre=yeniSifre.value;
 localStorage.setItem("users",JSON.stringify(users));
 sifreHata.textContent="Åifre deÄŸiÅŸti";
}

function toggle(id){document.getElementById(id).classList.toggle("hidden")}
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, onValue, onDisconnect }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig={
 apiKey:"AIzaSyD36TC6n4kR6wBoiownR7L2iCQyBrAwq1k",
 authDomain:"a-79192.firebaseapp.com",
 databaseURL:"https://a-79192-default-rtdb.firebaseio.com",
 projectId:"a-79192",
 storageBucket:"a-79192.firebasestorage.app",
 messagingSenderId:"29833951990",
 appId:"1:29833951990:web:36cda4e2ce8fb9ef4b4ad7"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);
window.db=db;

window.firebaseOnline=(u)=>{
 const r=ref(db,"status/"+u);
 const c=ref(db,".info/connected");
 onValue(c,s=>{
  if(s.val()){
   onDisconnect(r).set({name:u,state:"offline",last:Date.now()});
   set(r,{name:u,state:"online",last:Date.now()});
  }
 });
};

window.startStatusListener=()=>{
 const r=ref(db,"status");
 onValue(r,s=>{
  onlineDiv.innerHTML=Object.values(s.val()||{})
   .filter(x=>x.state==="online")
   .map(x=>"ğŸŸ¢ "+x.name)
   .join("<br>");
 });
};
</script>

</body>
</html>
