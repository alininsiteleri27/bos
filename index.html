<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>11/A Ali'nin Paneli</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">

<style>
#sonucFoto{
  width:160px;height:200px;object-fit:cover;margin:14px auto 0;
  display:none;opacity:0;transform:scale(.9);
  transition:.3s;border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.6)
}
#sonucFoto.show{opacity:1;transform:scale(1)}
@media(max-width:600px){#sonucFoto{width:120px;height:150px}}
.hidden{display:none;}
.admin-toggle{cursor:pointer;color:var(--accent);font-weight:700;margin-bottom:6px;display:inline-block;}
</style>
</head>

<body>

<div id="loginBox" class="login-box">
  <h2>11/A Panel GiriÅŸi</h2>
  <input id="kullanici" placeholder="KullanÄ±cÄ± adÄ±">
  <input id="sifre" type="password" placeholder="Åifre">
  <button onclick="giris()">GiriÅŸ Yap</button>
  <p id="loginHata"></p>
</div>

<main id="panel" class="app hidden">

<header class="topbar">
  <h1 id="hosgeldin"></h1>
  <div>
    <button onclick="darkMode()">ğŸŒ™</button>
    <button onclick="cikis()" class="logout-btn">
      <span>â»</span> Ã‡Ä±kÄ±ÅŸ Yap
    </button>
  </div>
</header>

<div class="search-box">
  <input id="arama" placeholder="isim ara">
  <button id="searchBtn">Ara</button>
</div>

<p id="ad"></p>
<p id="sonuc"></p>
<img id="sonucFoto">

<section id="adminPanel" class="announcements hidden">
  <h3>ğŸ‘‘ Admin Paneli</h3>

  <div class="admin-toggle" onclick="toggleSection('onlineSection')">ğŸŸ¢ Online KullanÄ±cÄ±lar</div>
  <div id="onlineSection" class="hidden"><div id="onlineList"></div></div>

  <div class="admin-toggle" onclick="toggleSection('logSection')">ğŸ“œ Loglar</div>
  <div id="logSection" class="hidden"><div id="loglar"></div></div>

  <div class="admin-toggle" onclick="toggleSection('istatistikSection')">ğŸ“Š Arama Ä°statistikleri</div>
  <div id="istatistikSection" class="hidden"><div id="istatistik"></div></div>

  <div class="admin-toggle" onclick="toggleSection('detaySection')">ğŸ§  DetaylÄ± Arama GeÃ§miÅŸi</div>
  <div id="detaySection" class="hidden"><div id="aramaDetayDiv"></div></div>

  <div class="admin-toggle" onclick="toggleSection('sifreSection')">ğŸ”‘ Åifre DeÄŸiÅŸtir</div>
  <div id="sifreSection" class="hidden">
    <select id="sifreUserSelect"></select>
    <input id="yeniSifre" placeholder="Yeni Åifre">
    <button onclick="degistirSifre()">DeÄŸiÅŸtir</button>
    <p id="sifreHata"></p>
  </div>
</section>

</main>

<audio id="successSound" src="sounds/success.mp3"></audio>
<audio id="errorSound" src="sounds/error.mp3"></audio>

<script>
window.addEventListener("load",()=>{
  localStorage.removeItem("onlineUsers");
  localStorage.removeItem("aktifKullanici");
});

/* === DOM === */
const kullanici=document.getElementById("kullanici"),
sifre=document.getElementById("sifre"),
loginBox=document.getElementById("loginBox"),
panel=document.getElementById("panel"),
hosgeldin=document.getElementById("hosgeldin"),
adminPanel=document.getElementById("adminPanel"),
loglar=document.getElementById("loglar"),
onlineList=document.getElementById("onlineList"),
istatistik=document.getElementById("istatistik"),
aramaDetayDiv=document.getElementById("aramaDetayDiv"),
searchBtn=document.getElementById("searchBtn"),
arama=document.getElementById("arama"),
ad=document.getElementById("ad"),
sonuc=document.getElementById("sonuc"),
sonucFoto=document.getElementById("sonucFoto"),
sifreUserSelect=document.getElementById("sifreUserSelect"),
yeniSifre=document.getElementById("yeniSifre"),
sifreHata=document.getElementById("sifreHata"),
loginHata=document.getElementById("loginHata"),
successSound=document.getElementById("successSound"),
errorSound=document.getElementById("errorSound");

/* === USERS === */
let users=JSON.parse(localStorage.getItem("users"))||{
  admin:{sifre:"admin123",rol:"admin"},
  kÃ¼pra:{sifre:"k123",rol:"user"},
  yusuf:{sifre:"y123",rol:"user"},
  beyza:{sifre:"b123",rol:"user"},
  enes:{sifre:"e123",rol:"user"},
  hira:{sifre:"h123",rol:"user"},
  hacer:{sifre:"ha123",rol:"user"},
  deniz:{sifre:"d123",rol:"user"},
  efe:{sifre:"ef123",rol:"user"},
  ayhan:{sifre:"a123",rol:"user"},
  dilber:{sifre:"di123",rol:"user"},
  samet:{sifre:"s123",rol:"user"},
  ipek:{sifre:"i123",rol:"user"},
  esma:{sifre:"es123",rol:"user"},
  sude:{sifre:"su123",rol:"user"},
  cehennet:{sifre:"c123",rol:"user"},
  berke:{sifre:"be123",rol:"user"},
  emin:{sifre:"em123",rol:"user"},
  hashÃ¼s:{sifre:"haÅŸ123",rol:"user"},
  bÃ¼nyamin:{sifre:"bÃ¼123",rol:"user"},
  efsa:{sifre:"efsa123",rol:"user"},
  merve:{sifre:"m123",rol:"user"},
  cilo:{sifre:"ci123",rol:"user"},
  emre:{sifre:"er123",rol:"user"},
  yiÄŸit:{sifre:"yÄ±123",rol:"user"}
};
localStorage.setItem("users",JSON.stringify(users));

let aktifKullanici="";
let onlineUsers={};

/* === LOGIN === */
function giris(){
  const k=kullanici.value.toLowerCase().trim();
  if(users[k]&&users[k].sifre===sifre.value){
    aktifKullanici=k;
    loginBox.classList.add("hidden");
    panel.classList.remove("hidden");
    hosgeldin.textContent="HoÅŸgeldin "+k.toUpperCase();
    firebaseOnline(k);

    if(users[k].rol==="admin"){
      adminPanel.classList.remove("hidden");
      sifreUserSelect.innerHTML=Object.keys(users)
        .filter(u=>u!=="admin")
        .map(u=>`<option>${u}</option>`).join("");
      startStatusListener();
    }
  }else{
    loginHata.textContent="HatalÄ± giriÅŸ";
    errorSound.play();
  }
}

function cikis(){
  if(aktifKullanici && window.db){
    firebaseSet(firebaseRef("status/"+aktifKullanici),{
      name:aktifKullanici,
      state:"offline",
      last:Date.now()
    });
  }
  location.reload();
}

function toggleSection(id){
  document.getElementById(id).classList.toggle("hidden");
}
function darkMode(){
  document.body.classList.toggle("dark");
}
  <script>
searchBtn.onclick = () => {
  const key = arama.value.toLowerCase().trim();
  if(!kisiler[key]) return;

  const k = kisiler[key];
  ad.textContent = k.ad;
  sonuc.textContent = k.mesaj;
  sonucFoto.src = k.foto;
  sonucFoto.style.display = "block";
  setTimeout(()=>sonucFoto.classList.add("show"),10);
};
</script>


/* === KISILER (AYNEN) === */
const kisiler={
  kÃ¼pra:{ad:"KÃ¼pra",mesaj:"hafif",foto:"fotos/kÃ¼pra.jpg"},
  yusuf:{ad:"Yusuf",mesaj:"Ä±rkÃ§Ä±",foto:"fotos/yusuf.jpg"},
  beyza:{ad:"Beyza",mesaj:"egoist sÄ±Ã§an",foto:"fotos/beyza.jpg"},
  enes:{ad:"Enes",mesaj:"kkaahhppee",foto:"fotos/enes.jpg"},
  hira:{ad:"Hira",mesaj:"beyinsiz",foto:"fotos/hira.jpg"},
  hacer:{ad:"Hacer",mesaj:"erkek",foto:"fotos/hacer.jpg"},
  deniz:{ad:"Deniz",mesaj:"taklitman",foto:"fotos/deniz.jpg"},
  efe:{ad:"Efe",mesaj:"yaÅŸÄ±yor",foto:"fotos/efe.jpg"},
  ayhan:{ad:"Ayhan",mesaj:"gergin adam",foto:"fotos/ayhan.jpg"},
  dilber:{ad:"Dilber",mesaj:"ÅŸevvalin50tonu",foto:"fotos/dilber.jpg"},
  samet:{ad:"Samet",mesaj:"baÅŸkan",foto:"fotos/samet.jpg"},
  ipek:{ad:"Ä°pek",mesaj:"gergedan",foto:"fotos/ipek.jpg"},
  esma:{ad:"Esma",mesaj:"umrede",foto:"fotos/esma.jpg"},
  sude:{ad:"Sude",mesaj:"gÃ¶zlÃ¼k yokki",foto:"fotos/sude.jpg"},
  cehennet:{ad:"Cehennet",mesaj:"depremci",foto:"fotos/cehennet.jpg"},
  berke:{ad:"Berke",mesaj:"kas kÃ¼tlesi",foto:"fotos/berke.jpg"},
  emin:{ad:"Emin",mesaj:"atatÃ¼rk",foto:"fotos/emin.jpg"},
  hashÃ¼s:{ad:"HashÃ¼s",mesaj:"ineÄŸin kalÃ§asÄ±",foto:"fotos/hashÃ¼s.jpg"},
  bÃ¼nyamin:{ad:"BÃ¼nyamin",mesaj:"bilekkÄ±ran",foto:"fotos/bÃ¼nyamin.jpg"},
  efsa:{ad:"Efsa",mesaj:"baÅŸkaniye",foto:"fotos/efsa.jpg"},
  merve:{ad:"Merve",mesaj:"efsanÄ±n elli tonu",foto:"fotos/merve.jpg"},
  cilo:{ad:"Cilo",mesaj:"godfather",foto:"fotos/cilo.jpg"},
  emre:{ad:"Emre",mesaj:"bÄ±yÄ±klÄ±",foto:"fotos/emre.jpg"},
  yiÄŸit:{ad:"YiÄŸit",mesaj:"bjkci",foto:"fotos/yiÄŸit.jpg"}
};
  <script>
searchBtn.onclick = () => {
  const key = arama.value.toLowerCase().trim();
  if(!kisiler[key]) return;

  const k = kisiler[key];
  ad.textContent = k.ad;
  sonuc.textContent = k.mesaj;
  sonucFoto.src = k.foto;
  sonucFoto.style.display = "block";
  sonucFoto.classList.remove("show");
  setTimeout(()=>sonucFoto.classList.add("show"),10);
};
</script>
  <script>
function ara(){
  const q = arama.value.toLowerCase().trim();
  if(!q) return;

  const kisi = kisiler[q];
  if(kisi){
    ad.textContent = kisi.ad;
    sonuc.textContent = kisi.mesaj;

    sonucFoto.src = kisi.foto;
    sonucFoto.style.display = "block";
    setTimeout(()=>sonucFoto.classList.add("show"),10);

    successSound.play();
  }else{
    ad.textContent = "";
    sonuc.textContent = "BulunamadÄ± âŒ";
    sonucFoto.classList.remove("show");
    setTimeout(()=>sonucFoto.style.display="none",300);
    errorSound.play();
  }
}

/* buton tÄ±k */
searchBtn.addEventListener("click", ara);

/* enter ile arama */
arama.addEventListener("keydown", e=>{
  if(e.key==="Enter") ara();
});
</script>


</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, onValue, onDisconnect }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig={
 apiKey:"AIzaSyD36TC6n4kR6wBoiownR7L2iCQyBrAwq1k",
 authDomain:"a-79192.firebaseapp.com",
 databaseURL:"https://a-79192-default-rtdb.firebaseio.com",
 projectId:"a-79192",
 storageBucket:"a-79192.firebasestorage.app",
 messagingSenderId:"29833951990",
 appId:"1:29833951990:web:36cda4e2ce8fb9ef4b4ad7"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);
window.db=db;

window.firebaseRef=(p)=>ref(db,p);
window.firebaseSet=set;

/* === ONLINE FIX === */
window.firebaseOnline=(u)=>{
 const statusRef=ref(db,"status/"+u);
 const connRef=ref(db,".info/connected");

 onValue(connRef,s=>{
  if(s.val()){
    onDisconnect(statusRef).set({
      name:u,state:"offline",last:Date.now()
    });
    set(statusRef,{
      name:u,state:"online",last:Date.now()
    });
  }
 });
};

window.startStatusListener=()=>{
 const r=ref(db,"status");
 onValue(r,s=>{
  const v=s.val()||{};
  onlineList.innerHTML=Object.values(v)
    .filter(x=>x.state==="online")
    .map(x=>"ğŸŸ¢ "+x.name)
    .join("<br>");
 });
};
</script>

</body>
</html>
